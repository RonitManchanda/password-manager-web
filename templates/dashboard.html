{% extends "base.html" %}
{% block content %}
<div class="grid two">
  <div class="card">
    <h2>Your Vault</h2>
    {% if not has_master %}
      <p class="subtle">Unlock your vault with your master password. It never leaves your browser.</p>
      <form method="post" class="grid">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div>
          <label>Master password</label>
          <input class="input" name="master_password" type="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
        </div>
        <div style="display:flex; gap:8px; justify-content:flex-end;">
          <button class="btn" type="submit">Unlock</button>
        </div>
      </form>
    {% else %}
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <a class="btn" href="{{ url_for('add') }}">Ôºã Add Entry</a>
        <span class="subtle" style="align-self:center;">Vault unlocked for this session</span>
      </div>
    {% endif %}
  </div>

  <div class="card">
    <h2>Security Status</h2>
    <div class="subtle">2FA is required when revealing passwords. Email delivery uses your configured SMTP sender.</div>
    <ul class="subtle" style="margin-top:10px; line-height:1.7;">
      <li>End-to-end encryption with your master key (Fernet).</li>
      <li>Per-user vault salt (PBKDF2).</li>
      <li>One-time codes for sensitive actions.</li>
    </ul>
  </div>
</div>

<div class="card">
  <h2>Stored Accounts</h2>
  {% if entries %}
    <table class="table">
      <thead>
        <tr><th>Account</th><th>Username</th><th style="text-align:right;">Actions</th></tr>
      </thead>
      <tbody>
      {% for e in entries %}
        <tr>
          <td><strong>{{ e.account }}</strong></td>
          <td><span class="subtle">{{ e.username }}</span></td>
          <td>
            <div class="row-actions">
              <a class="btn sm" href="{{ url_for('reveal', entry_id=e.id) }}">Reveal</a>
              <form method="post" action="{{ url_for('delete', entry_id=e.id) }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button class="btn sm secondary" type="submit" onclick="return confirm('Delete this entry?')">
                  Delete
                </button>
              </form>
            </div>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="empty">
      <div class="emoji">üóÉÔ∏è</div>
      <div>No entries yet.</div>
      <div style="margin-top:12px;">
        <a class="btn" href="{{ url_for('add') }}">Add your first entry</a>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}
